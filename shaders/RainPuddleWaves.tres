[gd_resource type="VisualShader" load_steps=28 format=3 uid="uid://mmfwgleckj54"]

[ext_resource type="Texture2D" uid="uid://bx4nutgp8du4x" path="res://shaders/T_Water_N.exr" id="2_uxjoh"]

[sub_resource type="VisualShaderNodeColorConstant" id="VisualShaderNodeColorConstant_uxjoh"]
constant = Color(0, 0, 0, 1)

[sub_resource type="VisualShaderNodeFloatConstant" id="VisualShaderNodeFloatConstant_prip4"]
constant = 0.15

[sub_resource type="VisualShaderNodeExpression" id="VisualShaderNodeExpression_c64tp"]
size = Vector2(1540, 2920)
expression = "// Ažurirani Ulazi Expression Nodea:
// node_position_world (vec3)  // World Position
// WaterN (sampler2D)          // Tekstura (Normal Mapa)
// wind_waves (float)          // Intenzitet/Mix
// waves_time (float)          // Vrijeme
// tiling_scale (float)        // Skala za ponavljanje (Tiling)

// Izlaz Expression Nodea:
// final_normal (vec3)         // Konačna Normala s valovima (Tangent Space)

// Konstante za pomak i brzinu
const vec4 wavesPosOffset = vec4(0.018, 0.013, 0.007, 0.017);
const vec4 wavesTimeOffset = vec4(0.4, 0.02, -0.1, 0.4);

// 1. Skaliranje i priprema World Positiona za Panning
// Koristimo 'node_position_world' (Input) i FloatConstant (npr. 0.01)
// 'n_out60p0' je izbačen/ignoriran
vec3 scaled_world_pos = node_position_world * tiling_scale; 
vec4 world_pos_4D = vec4(scaled_world_pos, 0.0);

// 2. Priprema UV Koordinata (World Pos + Time)
vec4 scaled_pos = world_pos_4D * wavesPosOffset;
vec4 scaled_time = waves_time * wavesTimeOffset;
vec4 final_uv_input = scaled_pos + scaled_time;

// 3. Razdvajanje UV Koordinate i WRAP (Ponavljanje)
vec2 uv1 = fract(final_uv_input.xy); 
vec2 uv2 = fract(final_uv_input.zw);

// 4. Uzorkovanje Teksture (Pretpostavka da je 'tex_frg_44' sampler)
vec4 map1_sample = texture(tex_frg_44, uv1);
vec4 map2_sample = texture(tex_frg_44, uv2);

// 5. Unpack i Kombiniranje X/Y pomaka (Tangent X/Y)
vec2 unpacked_map1_xy = (map1_sample.xy * 2.0) - 1.0;
vec2 unpacked_map2_xy = (map2_sample.xy * 2.0) - 1.0;
vec2 local21_combined = unpacked_map1_xy + unpacked_map2_xy;

// 6. Skaliranje (Intenzitet/Jačina)
float intensity_local0 = mix(0.25, 0.5, wind_waves);
vec2 local22_scaled = local21_combined * intensity_local0;

// 7. Kombiniranje Z komponente (Dubina/Tangent Z)
float local23_z = map1_sample.b * map2_sample.b;

// 8. Finalna Normala (Tangent Space Normala)
vec3 tangent_normal = vec3(local22_scaled, local23_z);

// 9. Normalizacija i Izlaz
final_normal = normalize(tangent_normal);"

[sub_resource type="VisualShaderNodeInput" id="VisualShaderNodeInput_elnga"]
input_name = "time"

[sub_resource type="VisualShaderNodeFloatConstant" id="VisualShaderNodeFloatConstant_dya5c"]
constant = 0.05

[sub_resource type="VisualShaderNodeFloatConstant" id="VisualShaderNodeFloatConstant_xhdws"]
constant = 0.55

[sub_resource type="VisualShaderNodeInput" id="VisualShaderNodeInput_i8f8t"]
input_name = "node_position_world"

[sub_resource type="VisualShaderNodeFloatConstant" id="VisualShaderNodeFloatConstant_uxjoh"]
constant = 0.05

[sub_resource type="VisualShaderNodeTexture" id="VisualShaderNodeTexture_prip4"]
expanded_output_ports = [0]
texture = ExtResource("2_uxjoh")

[sub_resource type="VisualShaderNodeUVFunc" id="VisualShaderNodeUVFunc_uxjoh"]
default_input_values = [1, Vector2(1, 1), 2, Vector2(0.1, 0.1)]

[sub_resource type="VisualShaderNodeTexture" id="VisualShaderNodeTexture_xhdws"]
expanded_output_ports = [0]
texture = ExtResource("2_uxjoh")

[sub_resource type="VisualShaderNodeInput" id="VisualShaderNodeInput_fkcai"]
input_name = "time"

[sub_resource type="VisualShaderNodeUVFunc" id="VisualShaderNodeUVFunc_hjgei"]
default_input_values = [1, Vector2(1, 1), 2, Vector2(-0.1, -0.1)]

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_ufuhs"]
default_input_values = [0, 0.018, 1, 0.013, 2, 0.007, 3, 0.017]
expanded_output_ports = [0]
op_type = 2

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_i8f8t"]
default_input_values = [0, 0.4, 1, 0.02, 2, -0.1, 3, 0.4]
op_type = 2

[sub_resource type="VisualShaderNodeInput" id="VisualShaderNodeInput_eqt2p"]
input_name = "time"

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_ld84k"]
operator = 2

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_ljwvn"]
operator = 2

[sub_resource type="VisualShaderNodeFloatOp" id="VisualShaderNodeFloatOp_6m0fw"]
operator = 2

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_fcnd8"]

[sub_resource type="VisualShaderNodeVectorOp" id="VisualShaderNodeVectorOp_li4xg"]
default_input_values = [0, Vector2(0, 0), 1, Vector2(0, 0)]
expanded_output_ports = [0]
op_type = 0
operator = 2

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_y5un5"]
op_type = 0

[sub_resource type="VisualShaderNodeVectorOp" id="VisualShaderNodeVectorOp_aujwa"]
default_input_values = [0, Vector3(0, 0, 0), 1, Vector3(2, 2, 2)]
operator = 2

[sub_resource type="VisualShaderNodeVectorOp" id="VisualShaderNodeVectorOp_l2tmb"]
default_input_values = [0, Vector3(0, 0, 0), 1, Vector3(1, 1, 1)]
operator = 1

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_ci87j"]
op_type = 0

[sub_resource type="VisualShaderNodeVectorCompose" id="VisualShaderNodeVectorCompose_2evoa"]
op_type = 0

[resource]
code = "shader_type spatial;
render_mode blend_mix, depth_draw_opaque, depth_test_default, cull_back, diffuse_lambert, specular_schlick_ggx;

uniform sampler2D tex_frg_49;
uniform sampler2D tex_frg_52;



void fragment() {
// ColorConstant:12
	vec4 n_out12p0 = vec4(0.000000, 0.000000, 0.000000, 1.000000);


// FloatConstant:13
	float n_out13p0 = 0.150000;


// FloatConstant:42
	float n_out42p0 = 0.550000;


// VectorCompose:56
	float n_in56p0 = 0.01800;
	float n_in56p1 = 0.01300;
	float n_in56p2 = 0.00700;
	float n_in56p3 = 0.01700;
	vec4 n_out56p0 = vec4(n_in56p0, n_in56p1, n_in56p2, n_in56p3);
	float n_out56p1 = n_out56p0.r;
	float n_out56p2 = n_out56p0.g;
	float n_out56p3 = n_out56p0.b;


// VectorCompose:64
	vec2 n_out64p0 = vec2(n_out56p1, n_out56p2);


// Input:53
	float n_out53p0 = TIME;


// UVFunc:50
	vec2 n_in50p2 = vec2(0.10000, 0.10000);
	vec2 n_out50p0 = n_in50p2 * vec2(n_out53p0) + UV;


// VectorOp:63
	vec2 n_out63p0 = n_out64p0 * n_out50p0;


// Texture2D:49
	vec4 n_out49p0 = texture(tex_frg_49, n_out63p0);
	float n_out49p1 = n_out49p0.r;
	float n_out49p2 = n_out49p0.g;
	float n_out49p3 = n_out49p0.b;


// UVFunc:54
	vec2 n_in54p2 = vec2(-0.10000, -0.10000);
	vec2 n_out54p0 = n_in54p2 * vec2(n_out53p0) + UV;


// Texture2D:52
	vec4 n_out52p0 = texture(tex_frg_52, n_out54p0);
	float n_out52p1 = n_out52p0.r;
	float n_out52p2 = n_out52p0.g;
	float n_out52p3 = n_out52p0.b;


// FloatOp:59
	float n_out59p0 = n_out49p1 * n_out52p1;


// FloatOp:60
	float n_out60p0 = n_out49p2 * n_out52p2;


// FloatOp:61
	float n_out61p0 = n_out52p3 * n_out49p3;


// VectorCompose:62
	vec3 n_out62p0 = vec3(n_out59p0, n_out60p0, n_out61p0);


// VectorOp:65
	vec3 n_in65p1 = vec3(2.00000, 2.00000, 2.00000);
	vec3 n_out65p0 = n_out62p0 * n_in65p1;


// VectorOp:66
	vec3 n_in66p1 = vec3(1.00000, 1.00000, 1.00000);
	vec3 n_out66p0 = n_out65p0 - n_in66p1;


// Output:0
	ALBEDO = vec3(n_out12p0.xyz);
	ROUGHNESS = n_out13p0;
	SPECULAR = n_out42p0;
	NORMAL = n_out66p0;


}
"
nodes/fragment/0/position = Vector2(-880, 1440)
nodes/fragment/12/node = SubResource("VisualShaderNodeColorConstant_uxjoh")
nodes/fragment/12/position = Vector2(-2140, 620)
nodes/fragment/13/node = SubResource("VisualShaderNodeFloatConstant_prip4")
nodes/fragment/13/position = Vector2(-2160, 1300)
nodes/fragment/38/node = SubResource("VisualShaderNodeExpression_c64tp")
nodes/fragment/38/position = Vector2(-8460, 1260)
nodes/fragment/38/size = Vector2(1540, 2920)
nodes/fragment/38/input_ports = "0,4,node_position_world;1,0,wind_waves;2,0,waves_time;3,5,WaterN;4,0,tiling_scale;"
nodes/fragment/38/output_ports = "0,4,final_normal;"
nodes/fragment/38/expression = "// Ažurirani Ulazi Expression Nodea:
// node_position_world (vec3)  // World Position
// WaterN (sampler2D)          // Tekstura (Normal Mapa)
// wind_waves (float)          // Intenzitet/Mix
// waves_time (float)          // Vrijeme
// tiling_scale (float)        // Skala za ponavljanje (Tiling)

// Izlaz Expression Nodea:
// final_normal (vec3)         // Konačna Normala s valovima (Tangent Space)

// Konstante za pomak i brzinu
const vec4 wavesPosOffset = vec4(0.018, 0.013, 0.007, 0.017);
const vec4 wavesTimeOffset = vec4(0.4, 0.02, -0.1, 0.4);

// 1. Skaliranje i priprema World Positiona za Panning
// Koristimo 'node_position_world' (Input) i FloatConstant (npr. 0.01)
// 'n_out60p0' je izbačen/ignoriran
vec3 scaled_world_pos = node_position_world * tiling_scale; 
vec4 world_pos_4D = vec4(scaled_world_pos, 0.0);

// 2. Priprema UV Koordinata (World Pos + Time)
vec4 scaled_pos = world_pos_4D * wavesPosOffset;
vec4 scaled_time = waves_time * wavesTimeOffset;
vec4 final_uv_input = scaled_pos + scaled_time;

// 3. Razdvajanje UV Koordinate i WRAP (Ponavljanje)
vec2 uv1 = fract(final_uv_input.xy); 
vec2 uv2 = fract(final_uv_input.zw);

// 4. Uzorkovanje Teksture (Pretpostavka da je 'tex_frg_44' sampler)
vec4 map1_sample = texture(tex_frg_44, uv1);
vec4 map2_sample = texture(tex_frg_44, uv2);

// 5. Unpack i Kombiniranje X/Y pomaka (Tangent X/Y)
vec2 unpacked_map1_xy = (map1_sample.xy * 2.0) - 1.0;
vec2 unpacked_map2_xy = (map2_sample.xy * 2.0) - 1.0;
vec2 local21_combined = unpacked_map1_xy + unpacked_map2_xy;

// 6. Skaliranje (Intenzitet/Jačina)
float intensity_local0 = mix(0.25, 0.5, wind_waves);
vec2 local22_scaled = local21_combined * intensity_local0;

// 7. Kombiniranje Z komponente (Dubina/Tangent Z)
float local23_z = map1_sample.b * map2_sample.b;

// 8. Finalna Normala (Tangent Space Normala)
vec3 tangent_normal = vec3(local22_scaled, local23_z);

// 9. Normalizacija i Izlaz
final_normal = normalize(tangent_normal);"
nodes/fragment/40/node = SubResource("VisualShaderNodeInput_elnga")
nodes/fragment/40/position = Vector2(-9080, 1560)
nodes/fragment/41/node = SubResource("VisualShaderNodeFloatConstant_dya5c")
nodes/fragment/41/position = Vector2(-9000, 1200)
nodes/fragment/42/node = SubResource("VisualShaderNodeFloatConstant_xhdws")
nodes/fragment/42/position = Vector2(-2140, 1580)
nodes/fragment/46/node = SubResource("VisualShaderNodeInput_i8f8t")
nodes/fragment/46/position = Vector2(-9100, 1000)
nodes/fragment/48/node = SubResource("VisualShaderNodeFloatConstant_uxjoh")
nodes/fragment/48/position = Vector2(-9020, 2500)
nodes/fragment/49/node = SubResource("VisualShaderNodeTexture_prip4")
nodes/fragment/49/position = Vector2(-3180, 1800)
nodes/fragment/50/node = SubResource("VisualShaderNodeUVFunc_uxjoh")
nodes/fragment/50/position = Vector2(-4200, 2380)
nodes/fragment/52/node = SubResource("VisualShaderNodeTexture_xhdws")
nodes/fragment/52/position = Vector2(-3200, 2640)
nodes/fragment/53/node = SubResource("VisualShaderNodeInput_fkcai")
nodes/fragment/53/position = Vector2(-5200, 2740)
nodes/fragment/54/node = SubResource("VisualShaderNodeUVFunc_hjgei")
nodes/fragment/54/position = Vector2(-4160, 2800)
nodes/fragment/56/node = SubResource("VisualShaderNodeVectorCompose_ufuhs")
nodes/fragment/56/position = Vector2(-5440, 1800)
nodes/fragment/57/node = SubResource("VisualShaderNodeVectorCompose_i8f8t")
nodes/fragment/57/position = Vector2(-6180, 2620)
nodes/fragment/58/node = SubResource("VisualShaderNodeInput_eqt2p")
nodes/fragment/58/position = Vector2(-6200, 3100)
nodes/fragment/59/node = SubResource("VisualShaderNodeFloatOp_ld84k")
nodes/fragment/59/position = Vector2(-2560, 2260)
nodes/fragment/60/node = SubResource("VisualShaderNodeFloatOp_ljwvn")
nodes/fragment/60/position = Vector2(-2560, 2580)
nodes/fragment/61/node = SubResource("VisualShaderNodeFloatOp_6m0fw")
nodes/fragment/61/position = Vector2(-2560, 2920)
nodes/fragment/62/node = SubResource("VisualShaderNodeVectorCompose_fcnd8")
nodes/fragment/62/position = Vector2(-2180, 2500)
nodes/fragment/63/node = SubResource("VisualShaderNodeVectorOp_li4xg")
nodes/fragment/63/position = Vector2(-3700, 1840)
nodes/fragment/64/node = SubResource("VisualShaderNodeVectorCompose_y5un5")
nodes/fragment/64/position = Vector2(-4600, 1920)
nodes/fragment/65/node = SubResource("VisualShaderNodeVectorOp_aujwa")
nodes/fragment/65/position = Vector2(-2020, 1980)
nodes/fragment/66/node = SubResource("VisualShaderNodeVectorOp_l2tmb")
nodes/fragment/66/position = Vector2(-1660, 1980)
nodes/fragment/67/node = SubResource("VisualShaderNodeVectorCompose_ci87j")
nodes/fragment/67/position = Vector2(-5180, 3060)
nodes/fragment/68/node = SubResource("VisualShaderNodeVectorCompose_2evoa")
nodes/fragment/68/position = Vector2(-4620, 2280)
nodes/fragment/connections = PackedInt32Array(13, 0, 0, 3, 42, 0, 0, 4, 41, 0, 38, 1, 40, 0, 38, 2, 12, 0, 0, 0, 46, 0, 38, 0, 48, 0, 38, 4, 54, 0, 52, 0, 49, 1, 59, 0, 52, 1, 59, 1, 49, 2, 60, 0, 52, 2, 60, 1, 52, 3, 61, 0, 49, 3, 61, 1, 59, 0, 62, 0, 60, 0, 62, 1, 61, 0, 62, 2, 62, 0, 65, 0, 65, 0, 66, 0, 66, 0, 0, 8, 53, 0, 54, 1, 56, 1, 64, 0, 56, 2, 64, 1, 53, 0, 50, 1, 50, 0, 63, 1, 64, 0, 63, 0, 63, 0, 49, 0, 56, 3, 68, 0)
